if(chrome.declarativeNetRequest)chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:[1],addRules:[{id:1,priority:1,action:{type:"modifyHeaders",requestHeaders:[{header:"Referer",operation:"set",value:"https://scratch.mit.edu/"}]},condition:{domains:[chrome.runtime.id],regexFilter:"^https:\\/\\/(api\\.|clouddata\\.|)scratch\\.mit\\.edu\\/.*(\\?|\\&)sareferer",resourceTypes:["xmlhttprequest"]}}]})
else{const e=["blocking","requestHeaders"];({}).hasOwnProperty.call(chrome.webRequest.OnBeforeSendHeadersOptions,"EXTRA_HEADERS")&&e.push("extraHeaders"),chrome.webRequest.onBeforeSendHeaders.addListener((function(e){if(e.originUrl){if(new URL(e.originUrl).origin!==chrome.runtime.getURL("").slice(0,-1))return}else if(e.initiator!==chrome.runtime.getURL("").slice(0,-1))return
if(e.url.endsWith("?sareferer")||e.url.endsWith("&sareferer"))return e.requestHeaders.push({name:"Referer",value:"https://scratch.mit.edu/"}),{requestHeaders:e.requestHeaders}}),{urls:["https://scratch.mit.edu/*","https://api.scratch.mit.edu/*","https://clouddata.scratch.mit.edu/*"],types:["xmlhttprequest"]},e)}