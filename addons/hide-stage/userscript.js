export default async function({addon:e,msg:t}){function a(){i=1,n&&(document.body.classList.add("sa-stage-hidden-outer"),n.classList.add("sa-stage-hidden"),g.classList.remove(e.tab.scratchClass("stage-header_stage-button-toggled-off")),window.dispatchEvent(new Event("resize")))}function s(){i=0,n&&(document.body.classList.remove("sa-stage-hidden-outer"),n.classList.remove("sa-stage-hidden"),g.classList.add(e.tab.scratchClass("stage-header_stage-button-toggled-off")),window.dispatchEvent(new Event("resize")))}let n,o,d,g,i=0
for(e.self.addEventListener("disabled",(()=>s()));;){const u=await e.tab.waitForElement("[class*='stage-header_stage-size-toggle-group_']",{markAsSeen:1,reduxCondition(e){return!e.scratchGui.mode.isPlayerOnly}})
n=document.querySelector("[class*='gui_body-wrapper_']"),o=u.firstChild,o.classList.add("sa-stage-button-middle"),d=u.lastChild,g=Object.assign(document.createElement("div"),{role:"button",className:e.tab.scratchClass("button_outlined-button","stage-header_stage-button","stage-header_stage-button-first",{others:"sa-hide-stage-button"})}),e.tab.displayNoneWhileDisabled(g),u.insertBefore(g,o),g.appendChild(Object.assign(document.createElement("img"),{className:e.tab.scratchClass("stage-header_stage-button-icon"),src:e.self.dir+"/icon.svg",alt:t("hide-stage"),draggable:0})),i?a():s(),g.addEventListener("click",a),o.addEventListener("click",s),d.addEventListener("click",s)}}